<?php
/** @var $book \Application\Entity\Book */
?>
<div class="book_cl" data-url="<?= $this->url($route, $params); ?>">
    <article class="album">
        <header class="bf">
            <?
            $params['book'] = $book->getAlias(); ?>
            <a href="<?= $this->url($route, $params); ?>">
                <?
                if (stristr($book->getFoto(), "\n")
                    or empty($book->getFoto())
                    or !file_exists(
                        $_SERVER['DOCUMENT_ROOT']
                        .'/templates/newimg/small/'
                        .$book->getFoto()
                    )
                ): ?>
                    <img class="img-thumbnail"
                         src="/templates/newimg/small/nofoto.jpg">
                <? else: ?>
                    <img class="img-thumbnail"
                         src="/templates/newimg/small/<?= $book->getFoto(); ?>">
                <? endif; ?>
            </a>
            <?php echo $this->partial(
                'application/index/stars',
                [
                    'id_book'     => $book->getId(),
                    'aver_value'  => $book->getStars(),
                    'count_stars' => $book->getCountStars(),
                ]
            ); ?>
        </header>
        <section class="album-info">
            <h3><a href="<?= $this->url(
                    $route,
                    $params
                ); ?>"><?= $book->getName(); ?>
                </a>
                    <?
                    $link = '<a href="'.$this->url('home/admin-book',['action' => 'edit', 'id' => $book->getId()]).'">
                                 <i class="glyphicon glyphicon-edit"></i>
                            </a>
                    ';
                    ?>
                <?=$this->button()->changeBook($link);?>
            </h3>
            <ul class="no-list-style">
                <?
                $params['alias_menu'] = $book->getNAliasMenu();
                $params['action'] = 'one_genre';
                $params['s'] = $book->getNS();
                ?>

                <li>Жанр: <a href="<?= $this->url(
                        'home/genre/one',
                        $params
                    ); ?>"><?= $book->getNameZhanr(); ?></a></li>
                <li>Страниц: <span><?= $book->getKolStr(); ?></span></li>
                <li>Язык: <span><?= $book->getLang(); ?></span></li>
                <?if(!empty($this->getYear())):?>
                    <li>Год: <span><?= $book->getYear(); ?></span></li>
                <?endif;?>
                <? if ($book->getTypeFiles()): ?>
                    <li>Файлы: <span><?= $book->getTypeFiles(); ?></span></li>
                <? endif; ?>
                <? if(count($book->getAvtor())):?>
                    <li>Автор:
                    <?foreach($book->getAvtor() as $avtor):?>
                        <a href = "<?=$this->url(
                              'home/authors/one',
                              [
                                'alias_menu' => $avtor->getAlias()
                              ]
                        );?>"><?=$avtor->getName();?></a> /
                    <?endforeach;?>
                    </li>
                <?endif;?>
            </ul>
            <?
            if (!empty(trim($book->getTextSmall()))): ?>
                <button class="btn btn-white" data-toggle="popover"
                        data-trigger="click" data-placement="top"
                        data-content="<?= htmlspecialchars(
                            strip_tags($book->getTextSmall())
                        ); ?> " data-original-title="Анонс">Краткое
                    содержание
                </button>
            <? endif; ?>
        </section>
        <footer>
            <div class="album-images-count">
                <div class="text-right">
                    <i class="entypo-eye"></i>
                    <?= $book->getVisit(); ?>
                    <i class="entypo-calendar"></i>
                    <?= $book->getDateAdd()->format('d.m.Y'); ?>
                </div>
            </div>
        </footer>
    </article>
</div>
<!---->
<?//
//global $count_view, $rand, $rand1, $rand2;
//
//if ($count_view == null) {
//    $count_view = 0;
//    $rand = rand(4, 6);
//    $rand1 = rand(11, 13);
//    $rand2 = rand(22, 24);
//}
//$count_view++;
//
//if (in_array($count_view, [$rand, $rand1, $rand2])) {
//    ?>
<!--    <div class="book_cl no-padding">-->
<!--        <article class="album">-->
<!--            <script async-->
<!--                    src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
<!--            <ins class="adsbygoogle"-->
<!--                 style="display:block;width: 100%;"-->
<!--                 data-ad-format="fluid"-->
<!--                 data-ad-layout-key="-ao-1c-3k-8v+14f"-->
<!--                 data-ad-client="ca-pub-2745956118385780"-->
<!--                 data-ad-slot="8980418046"></ins>-->
<!--            <script>-->
<!--                (adsbygoogle = window.adsbygoogle || []).push({});-->
<!--            </script>-->
<!--        </article>-->
<!--    </div>-->
<!---->
<!--    --><?//
//}
//
//?>

